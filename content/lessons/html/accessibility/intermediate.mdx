# Accessibility

Building on the basics, let's explore ARIA attributes, advanced keyboard navigation, and focus management ‚Äî the tools that make complex interfaces accessible.

<AccessibilityChecker initialExample="form-labels" />

## ARIA: Accessible Rich Internet Applications

ARIA attributes add extra information to HTML elements for assistive technologies. They fill gaps when native HTML isn't enough.

### The First Rule of ARIA

> **Don't use ARIA if you can use native HTML instead.**

Native HTML elements have built-in accessibility. ARIA should only supplement, not replace, semantic HTML.

```html
<!-- Prefer this (native HTML) -->
<button>Submit</button>

<!-- Over this (ARIA on div) -->
<div role="button" tabindex="0">Submit</div>
```

<InfoBox type="warning" title="ARIA Can Break Things">
Incorrect ARIA is worse than no ARIA. It can confuse screen readers and make your site less accessible. Always test with actual assistive technology.
</InfoBox>

<ProgressCheckpoint section="introduction" xpReward={20} />

## Essential ARIA Attributes

### Roles

Roles define what an element is. Use them when you can't use the native HTML element:

```html
<!-- Landmark roles (prefer semantic HTML) -->
<div role="navigation">...</div>  <!-- Use <nav> instead -->
<div role="main">...</div>        <!-- Use <main> instead -->

<!-- Widget roles (when needed) -->
<div role="tablist">
  <button role="tab" aria-selected="true">Tab 1</button>
  <button role="tab" aria-selected="false">Tab 2</button>
</div>
<div role="tabpanel">Content for Tab 1</div>
```

### aria-label and aria-labelledby

Provide accessible names for elements:

```html
<!-- aria-label: Direct text label -->
<button aria-label="Close dialog">√ó</button>

<!-- aria-labelledby: Reference another element -->
<h2 id="section-title">User Settings</h2>
<form aria-labelledby="section-title">
  <!-- Form is labeled "User Settings" -->
</form>
```

### aria-describedby

Provides additional description:

```html
<label for="password">Password:</label>
<input type="password" id="password" 
       aria-describedby="password-help">
<p id="password-help">
  Must be at least 8 characters with one number.
</p>
```

<ScreenReaderSimulator initialExample="form-example" />

<ProgressCheckpoint section="accessibility-basics" xpReward={20} />

## ARIA States and Properties

### aria-expanded

Indicates if a collapsible element is open:

```html
<button aria-expanded="false" aria-controls="menu">
  Menu
</button>
<ul id="menu" hidden>
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
</ul>
```

```javascript
// Toggle the expanded state
button.addEventListener('click', () => {
  const expanded = button.getAttribute('aria-expanded') === 'true';
  button.setAttribute('aria-expanded', !expanded);
  menu.hidden = expanded;
});
```

### aria-hidden

Hides elements from assistive technology:

```html
<!-- Hide decorative icons from screen readers -->
<button>
  <span aria-hidden="true">üîç</span>
  Search
</button>

<!-- Hide duplicate content -->
<nav aria-label="Main">...</nav>
<nav aria-label="Mobile" aria-hidden="true">...</nav>
```

### aria-live

Announces dynamic content changes:

```html
<!-- Polite: Waits for pause in speech -->
<div aria-live="polite">
  3 items in your cart
</div>

<!-- Assertive: Interrupts immediately -->
<div aria-live="assertive" role="alert">
  Error: Please fix the form
</div>
```

<KeyConcept title="Live Regions">
Use `aria-live="polite"` for non-urgent updates (cart count, status messages). Use `aria-live="assertive"` or `role="alert"` only for critical errors.
</KeyConcept>

<ProgressCheckpoint section="aria-attributes" xpReward={20} />

## Advanced Keyboard Navigation

### Focus Management

Control where focus goes in your application:

```javascript
// Move focus to an element
document.getElementById('modal-title').focus();

// Trap focus within a modal
function trapFocus(element) {
  const focusable = element.querySelectorAll(
    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
  );
  const first = focusable[0];
  const last = focusable[focusable.length - 1];

  element.addEventListener('keydown', (e) => {
    if (e.key === 'Tab') {
      if (e.shiftKey && document.activeElement === first) {
        e.preventDefault();
        last.focus();
      } else if (!e.shiftKey && document.activeElement === last) {
        e.preventDefault();
        first.focus();
      }
    }
  });
}
```

### Skip Links

Allow keyboard users to skip repetitive content:

```html
<body>
  <a href="#main-content" class="skip-link">
    Skip to main content
  </a>
  <nav><!-- Long navigation --></nav>
  <main id="main-content">
    <!-- Main content -->
  </main>
</body>
```

```css
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  padding: 8px;
  background: #000;
  color: #fff;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}
```

### Roving tabindex

For composite widgets like toolbars or menus:

```html
<div role="toolbar" aria-label="Text formatting">
  <button tabindex="0">Bold</button>
  <button tabindex="-1">Italic</button>
  <button tabindex="-1">Underline</button>
</div>
```

```javascript
// Arrow keys move between buttons
toolbar.addEventListener('keydown', (e) => {
  const buttons = toolbar.querySelectorAll('button');
  const current = Array.from(buttons).indexOf(document.activeElement);
  
  if (e.key === 'ArrowRight') {
    const next = (current + 1) % buttons.length;
    buttons[current].tabIndex = -1;
    buttons[next].tabIndex = 0;
    buttons[next].focus();
  }
});
```

<ProgressCheckpoint section="keyboard-navigation" xpReward={20} />

## Common Accessibility Patterns

### Accessible Modal Dialog

```html
<div role="dialog" 
     aria-modal="true" 
     aria-labelledby="dialog-title">
  <h2 id="dialog-title">Confirm Action</h2>
  <p>Are you sure you want to delete this item?</p>
  <button>Cancel</button>
  <button>Delete</button>
</div>
```

Key requirements:
- `role="dialog"` and `aria-modal="true"`
- Focus moves into dialog when opened
- Focus is trapped within dialog
- Escape key closes dialog
- Focus returns to trigger element when closed

### Accessible Tabs

```html
<div role="tablist" aria-label="Product information">
  <button role="tab" 
          id="tab-1" 
          aria-selected="true" 
          aria-controls="panel-1">
    Description
  </button>
  <button role="tab" 
          id="tab-2" 
          aria-selected="false" 
          aria-controls="panel-2"
          tabindex="-1">
    Reviews
  </button>
</div>

<div role="tabpanel" 
     id="panel-1" 
     aria-labelledby="tab-1">
  Product description content...
</div>

<div role="tabpanel" 
     id="panel-2" 
     aria-labelledby="tab-2" 
     hidden>
  Reviews content...
</div>
```

<InfoBox type="tip" title="Use Established Patterns">
The WAI-ARIA Authoring Practices Guide provides tested patterns for common widgets. Don't reinvent the wheel!
</InfoBox>

<ProgressCheckpoint section="testing-tools" xpReward={10} />

## Key Takeaways

<KeyConcept title="Native HTML First">
Always prefer native HTML elements over ARIA. Use ARIA only to fill gaps.
</KeyConcept>

<KeyConcept title="Manage Focus Carefully">
When content changes dynamically, ensure focus moves appropriately and users aren't lost.
</KeyConcept>

<KeyConcept title="Test with Real Tools">
Use actual screen readers (NVDA, VoiceOver) to test your implementations, not just automated tools.
</KeyConcept>

<ProgressCheckpoint section="summary" xpReward={10} />

## Quick Quiz

<Quiz>
  <Question text="What's the first rule of ARIA?">
    <Answer>Always use ARIA on every element</Answer>
    <Answer correct>Don't use ARIA if native HTML works</Answer>
    <Answer>ARIA replaces semantic HTML</Answer>
    <Answer>Use aria-label on all elements</Answer>
  </Question>
  
  <Question text="Which aria-live value interrupts the screen reader immediately?">
    <Answer>polite</Answer>
    <Answer correct>assertive</Answer>
    <Answer>immediate</Answer>
    <Answer>urgent</Answer>
  </Question>
  
  <Question text="What does tabindex='-1' do?">
    <Answer>Makes element first in tab order</Answer>
    <Answer>Removes element from the page</Answer>
    <Answer correct>Removes from tab order but allows programmatic focus</Answer>
    <Answer>Makes element unfocusable</Answer>
  </Question>
</Quiz>

---

**Excellent progress!** üéâ You now understand ARIA and advanced keyboard patterns. In the advanced level, we'll explore WCAG 2.1 criteria in depth and professional testing methodologies.
